{% extends 'gambit/base.html' %}
{% block title %}Submission List - {% endblock %}
{% block styleinject %}{% load static %}<link rel='stylesheet' type='text/css' href='{% static 'gambit/datatables/datatables.min.css' %}'>{% endblock %}
{% block scriptinject %}<script type='text/javascript' charset='utf-8' src='{% static 'gambit/datatables/datatables.min.js' %}'></script>
<script>var editor;
$(document).ready(function(){
  $('#submissions').DataTable({
    dom: 'Blfrtip',
    colReorder: true,
    fixedHeader: true,
    pageLength: 10,
    select: true,
    responsive: true,
    buttons: [
      {
        text: 'This Years Submissions',
        action: function(e, dt, node, config) {
          dt.search('{% now "Y" %}').draw();
        }
      },
      {
        extend: 'collection',
        text: 'Export...',
        buttons: [
          'excel',
          'csv'
        ]
      }
    ]
  });
});</script>{% endblock %}
{% block content %}
<div class='panel panel-default'>
  <div class='panel-heading'>
    <h3 class='panel-title'><strong>Submission List</strong></h3>
  </div>
  <div class='submissions-table'>
    <table id='submissions' class='table table-striped table-responsive'>
      <thead>
        <th class='col-md-3'>Submission Title</th>
        <th class='col-md-3'>Reviews</th>
        <th class='col-md-3'>Average Score</th>
        <th class='col-md-3'>Submission Date</th>
      </thead>
      <tbody>
        {% for submission in submissions %}{% if user == submission.user %}<tr class='info'>
          <td><a href='{% url 'submission' submission.uuid %}'>{{ submission.title }}</a></td>
          <td>{{ submission.get_reviews|length }}</td>
          <td>{{ submission.get_average_score|default_if_none:0 }}</td>
          <td>{{ submission.submitted_on|date:'Y-m-d' }}</td>
        </tr>{% else %}<tr>
          <td><a href='{% url 'submission' submission.uuid %}'>{{ submission.title }}</a></td>
          <td>{{ submission.get_reviews|length }}</td>
          <td>{{ submission.get_average_score }}</td>
          <td>{{ submission.submitted_on|date:'Y-m-d' }}</td>
        </tr>{% endif %}{% empty %}
        <tr>
          <td colspan='3'>No sumbissions yet!</td>
        </tr>{% endfor %}
      </tbody>
    </table>
  </div>
  <div class='panel-footer'>
    <small>Your own submissions will be highlighted in <span class='bg-info'>blue</span>.</small>
  </div>
</div>
{% endblock %}
